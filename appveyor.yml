version: 1.1.0-{build}
pull_requests:
  do_not_increment_build_number: true
build_script:
- cmd: .\build.cmd BuildAndPackage
test:
  assemblies: 'Source\**\*.Specs.dll'
after_test:
- cmd:
    cd .\Build
    cd
    RunJavascriptSpecs.cmd
deploy: off
artifacts:
- path: artifacts\nuget\*
  name: nuget
on_success:
- cmd: >-
    msbuild Source\Documentation\Documentation.csproj /verbosity:minimal
    git clone https://github.com/dolittle/dolittle.github.io.git
    xcopy Source\Documentation\_site dolittle.github.io\bifrost /E /Y
    cd dolittle.github.io
    git add .
    git config --global user.name "Bifrost Documentation Account"
    git config --global user.email bifrost@dolittle.com
    git commit -m "<-- Autogenerated : documentation updated -->"
    git remote set-url origin https://%DOCS_USER%:%DOCS_TOKEN%@github.com/dolittle/dolittle.github.io.git
    git push
    cd ..
    rmdir dolittle.github.io /s /q
    verify > nul
